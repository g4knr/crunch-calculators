"use strict";(()=>{var C=(t,e)=>t.find(n=>n.year===e);var I=(t,e)=>{let n={style:"currency",currency:"GBP"};return e||(n.maximumSignificantDigits=21),new Intl.NumberFormat("gb-GB",n).format(t)};var x=(t,e)=>{for(let[n,a]of Object.entries(t)){a.render();let{toggleOptions:r}=a;!r||r.forEach(i=>{let l=i.option.name,c=a.nodeList.find(u=>u.value===l);t[i.query.name].getValue()===i.query.value?c.disabled=!1:(c.disabled=!0,c.checked===!0&&a.clear())})}for(let[n,a]of Object.entries(e))a.render()};var b=(t,e,n,a)=>{if(!t)return;let r=n(t),i=l=>{let c=r.year.getValue().toString(),s=C(e,c);if(!s)return;let u=a(l,r,s);x(r,u)};i(t),document.addEventListener("renderCalc",l=>{let{name:c,item:s}=l.detail;c==="change"&&s.type==="number"&&s.getValue()===""&&s.setValue("0"),i(t)})};var P=t=>({year:new o("year",{form:t}),dividendIncome:new o("dividend-income",{form:t}),otherIncome:new o("other-income",{form:t})});var w=(t,e)=>{if(!t)return;let n=t.closest('[data-calc="wrapper"]');!n||(e?n.style.removeProperty("display"):n.style.display="none")};var o=class{constructor(e,n){this.input=n.form[e],this.isNodeList=this.input instanceof NodeList,this.nodeList=this.isNodeList?[...this.input]:[this.input],this.type=this.nodeList[0].type,n.visibleIf&&(this.visibleIf=n.visibleIf),n.toggleOptions&&(this.toggleOptions=n.toggleOptions);let a=this.getValue();if(this.defaultValue=a.toString().length===0?0:a,!this.isNodeList){let r=this.input.getAttribute("data-calc-default");r&&(this.defaultValue=r)}(this.defaultValue===0||this.defaultValue)&&this.setValue(this.defaultValue),this.setVisibility(),this.nodeList.forEach(r=>{r.addEventListener("keyup",()=>{document.dispatchEvent(new CustomEvent("renderCalc",{detail:{name:"keyup",item:this}}))}),r.addEventListener("change",()=>{document.dispatchEvent(new CustomEvent("renderCalc",{detail:{name:"change",item:this}}))}),this.type==="number"&&(r.addEventListener("focus",()=>{this.getValueAsNumber()===0&&this.setValue("")}),r.addEventListener("focusout",()=>{this.getValueAsNumber()===0&&this.setValue("0")}))})}getValue(){return this.type==="checkbox"?this.input.checked:this.input.value}getValueAsNumber(){if(this.type!=="number")return NaN;let{valueAsNumber:e}=this.input;return isNaN(e)?0:e}setValue(e){switch(this.type){case"number":this.input.value=e.toString();break;case"select-one":this.input.value=e.toString();break;case"checkbox":this.input.checked=e;break;case"radio":this.input.value=e.toString();break}}setVisibility(){let e=this.nodeList[0];!e||!this.visibleIf||w(e,this.visibleIf())}toDefault(){!this.defaultValue||this.setValue(this.defaultValue)}clear(){switch(this.type){case"number":this.input.value="0";break;case"select-one":this.input.value=this.input.options[0].value;break;case"checkbox":this.input.checked=!1;break;case"radio":this.nodeList.forEach(e=>{e.checked=!1});break}}render(){this.setVisibility()}};var p=class{constructor(e,n){var a;this.element=n.form.querySelector(`[data-calc="${e}"]`),this.type=((a=this.element)==null?void 0:a.dataset.calcType)==="text"?"text":"currency",this.value=n.value,n.visibleIf&&(this.visibleIf=n.visibleIf),n.labels&&(this.labels=n.labels),this.setValue(),this.setVisibility()}getValue(){return this.value()}setValue(){if(!!this.element)switch(this.type){case"currency":this.element.textContent=I(Number(this.value()),!0);break;case"text":this.element.textContent=this.value().toString();break}}setVisibility(){!this.element||!this.visibleIf||w(this.element,this.visibleIf())}getLabel(){if(!this.element)return"";let e=this.element.closest('[data-calc="wrapper"]');if(!e)return"";let n=e.querySelector("label");return n&&n.textContent?n.textContent:""}setLabel(){if(!this.element)return;let e=this.element.closest('[data-calc="wrapper"]');if(!e)return;let n=e.querySelector("label");!n||!this.labels||(n.textContent=this.labels())}render(){this.setValue(),this.setVisibility()}};var E=[{year:"2020-21",rates:{ordinary:.075,upper:.325,additional:.381},allowances:{dividends:2e3,personal:12500,limit:1e5},bands:{basic:37500,higher:15e4}},{year:"2021-22",rates:{ordinary:.075,upper:.325,additional:.381},allowances:{dividends:2e3,personal:12570,limit:1e5},bands:{basic:37700,higher:15e4}},{year:"2022-23",rates:{ordinary:.0875,upper:.3375,additional:.3935},allowances:{dividends:2e3,personal:12570,limit:1e5},bands:{basic:37700,higher:15e4}}];var V=(t,e,n)=>{if(!e)return;let a={dividendProfits:new p("dividend-profits",{form:t,value:()=>e.dividendIncome.getValueAsNumber()}),taxToPay:new p("tax-to-pay",{form:t,value:()=>{let{rates:r,allowances:i,bands:l}=n,c=e.dividendIncome.getValueAsNumber(),s=e.otherIncome.getValueAsNumber(),u=c+s,m=s<=i.personal?i.personal-s:0,d=c-m-i.dividends;if(d<=0)return 0;let h=i.personal+l.basic,f=s<h?h-s-i.dividends:0,y=f===0?0:d>=f?f*r.ordinary:d*r.ordinary,g=u>l.higher?l.higher-s-i.dividends:u-l.basic-i.personal<=0?0:u-l.basic-i.personal,v=g===0?0:d>g?g*r.upper:(d-f)*r.upper,L=d-f-g<=0?0:(d-f-g)*r.additional;return y+v+L}}),allowance:new p("allowance",{form:t,value:()=>"\xA32,000 tax-free dividend allowance"})};return a.profitAfterTax=new p("profit-after-tax",{form:t,value:()=>e.dividendIncome.getValue()-a.taxToPay.value()}),a};var S=t=>{!t||b(t,E,P,V)};var A=[{year:"2020-21",exemption:12300,basicRate:{residential:.18,other:.1},higherRate:{residential:.28,other:.2},badr:.1,personalAllowance:12500,basicBand:37500,higherBand:15e4},{year:"2021-22",exemption:12300,basicRate:{residential:.18,other:.1},higherRate:{residential:.28,other:.2},badr:.1,personalAllowance:12570,basicBand:37700,higherBand:15e4},{year:"2022-23",exemption:12300,basicRate:{residential:.18,other:.1},higherRate:{residential:.28,other:.2},badr:.1,personalAllowance:12570,basicBand:37700,higherBand:15e4}];var F=t=>({year:new o("year",{form:t}),how:new o("how",{form:t}),capitalGains:new o("capital-gains",{form:t}),otherIncome:new o("other-income",{form:t})});var O=(t,e,n)=>{if(!e)return;let a={profit:new p("profit",{form:t,value:()=>{let r=e.capitalGains.getValueAsNumber();return r||0},labels:()=>{let r="";switch(e.how.getValue()){case"shares":r="shares";break;case"property":r="property";break;case"crypto":r="cryptocurrencies";break;case"other":r="other assets";break}return`Your profit from ${r}`}}),allowance:new p("allowance",{form:t,value:()=>`${I(n.exemption,!1)} tax-free CGT allowance`}),taxToPay:new p("tax-to-pay",{form:t,value:()=>{let r=e.capitalGains.getValueAsNumber(),i=e.otherIncome.getValueAsNumber(),{exemption:l,basicBand:c,personalAllowance:s,basicRate:u,higherRate:m,badr:d}=n,h=i<=c?i:c,f=s+c-h;f=f>=c?c:f;let y=r-l,g=y>=f?f:y,v=y-g,L=0;switch(e.how.getValue()){case"property":L=g*u.residential+v*m.residential;break;case"shares":L=g*d+v*d;break;default:L=g*u.other+v*m.other}return L}})};return a.profitAfterTax=new p("profit-after-tax",{form:t,value:()=>{let r=e.capitalGains.getValueAsNumber(),i=e.otherIncome.getValueAsNumber();return r+i-a.taxToPay.getValue()}}),a};var k=t=>{!t||b(t,A,F,O)};var N=[{year:"2020-21",figures:{UPL:5e4,PT:9500,SPT:6475,LPL:9500,eNIC:4e3},ni:{class1:{employee:{belowLEL:0,LELtoPT:0,PTtoUEL:.12,aboveUEL:.02},employer:{belowST:0,aboveST:.138,STtoUEL:0}},class1a:{employer:.138},class2:{belowSPT:0,SPTtoLPL:3.05,LPLtoUPL:3.05,aboveUPL:3.05},class4:{belowSPT:0,SPTtoLPL:0,LPLtoUPL:.09,aboveUPL:.02}}},{year:"2021-22",figures:{UPL:50270,PT:9568,SPT:6515,LPL:9568,eNIC:4e3},ni:{class1:{employee:{belowLEL:0,LELtoPT:0,PTtoUEL:.12,aboveUEL:.02},employer:{belowST:0,aboveST:.138,STtoUEL:0}},class1a:{employer:.138},class2:{belowSPT:0,SPTtoLPL:3.05,LPLtoUPL:3.05,aboveUPL:3.05},class4:{belowSPT:0,SPTtoLPL:0,LPLtoUPL:.09,aboveUPL:.02}}},{year:"2022-23",figures:{UPL:50270,PT:12570,SPT:6725,LPL:11908,eNIC:5e3},ni:{class1:{employee:{belowLEL:0,LELtoPT:0,PTtoUEL:.1325,aboveUEL:.0325},employer:{belowST:0,aboveST:.1505,STtoUEL:0}},class1a:{employer:.1453},class2:{belowSPT:0,SPTtoLPL:0,LPLtoUPL:3.15,aboveUPL:3.15},class4:{belowSPT:0,SPTtoLPL:0,LPLtoUPL:.1025,aboveUPL:.0325}}}];var U=t=>{let e={year:new o("year",{form:t}),isEmployed:new o("is-employed",{form:t}),isSelfEmployed:new o("is-self-employed",{form:t})};return e.annualSalary=new o("annual-salary",{form:t,visibleIf:()=>!!e.isEmployed.getValue()}),e.selfEmployedIncome=new o("self-employed-income",{form:t,visibleIf:()=>!!e.isSelfEmployed.getValue()}),e.selfEmployedExpenses=new o("self-employed-expenses",{form:t,visibleIf:()=>!!e.isSelfEmployed.getValue()}),e};var M=(t,e,n)=>{if(!e)return;let{UPL:a,PT:r,SPT:i,LPL:l,eNIC:c}=n.figures,{ni:s}=n,u={totalEarnings:new p("total-earnings",{form:t,value:()=>{let m=0;if(e.isEmployed.getValue()&&(m+=e.annualSalary.getValueAsNumber()),e.isSelfEmployed.getValue()){let d=e.selfEmployedExpenses.getValueAsNumber()>1e3?1e3:e.selfEmployedExpenses.getValue();m+=e.selfEmployedIncome.getValueAsNumber()-d}return m<0?0:m}}),allowance:new p("allowance",{form:t,value:()=>"\xA31,000 tax-free Trading Allowance",visibleIf:()=>!!e.isSelfEmployed.getValue()})};return u.niClass1=new p("ni-class1",{form:t,value:()=>{if(!e.isEmployed.getValue())return 0;let m=u.totalEarnings.getValue(),{employee:d,employer:h}=s.class1;return m<r?0:m>a?(a-r)*d.PTtoUEL+(m-a)*d.aboveUEL:(m-r)*d.PTtoUEL},visibleIf:()=>!!e.isEmployed.getValue()}),u.niClass2=new p("ni-class2",{form:t,value:()=>{if(!e.isSelfEmployed.getValue())return 0;let m=u.totalEarnings.getValue(),{belowSPT:d,SPTtoLPL:h,LPLtoUPL:f,aboveUPL:y}=s.class2;return m>i?h*52:0},visibleIf:()=>!!e.isSelfEmployed.getValue()}),u.niClass4=new p("ni-class4",{form:t,value:()=>{if(!e.isSelfEmployed.getValue())return 0;let m=u.totalEarnings.getValue(),{belowSPT:d,SPTtoLPL:h,LPLtoUPL:f,aboveUPL:y}=s.class4;return m<l?0:m>a?(a-l)*f+(m-a)*y:(m-l)*f},visibleIf:()=>!!e.isSelfEmployed.getValue()}),u.niTotal=new p("ni-total",{form:t,value:()=>Number(u.niClass1.value())+Number(u.niClass2.value())+Number(u.niClass4.value())}),u};var G=t=>{!t||b(t,N,U,M)};var H=[{year:"2021-22",pre10:{car:.45,van:.45,motorcycle:.24,bicycle:.2},post10:{car:.25,van:.25,motorcycle:.24,bicycle:.2}},{year:"2022-23",pre10:{car:.45,van:.45,motorcycle:.24,bicycle:.2},post10:{car:.25,van:.25,motorcycle:.24,bicycle:.2}}];var R=t=>{let e={year:new o("year",{form:t}),own:new o("own",{form:t})};return e.work=new o("work",{form:t,visibleIf:()=>e.own.getValue()==="yes"}),e.type=new o("type",{form:t,visibleIf:()=>e.work.visibleIf?e.work.visibleIf()&&e.work.getValue()==="yes":!1}),e.miles=new o("miles",{form:t,visibleIf:()=>e.type.visibleIf?e.type.visibleIf()&&e.type.getValue()!=="":!1}),e};var B=(t,e,n)=>e?{claim:new p("claim",{form:t,value:()=>{if(e.own.getValue()!=="yes"||e.work.getValue()!=="yes"||e.type.getValue()==="")return 0;let r=e.miles.getValueAsNumber(),i=r>=1e4?1e4:r,l=r>=1e4?r-1e4:0,c=n.pre10[e.type.getValue()]*i,s=n.post10[e.type.getValue()]*l;return c+s}})}:void 0;var q=t=>{console.log("mileage"),t&&b(t,H,R,B)};var D=[{year:"2020-21",studentLoans:{plan1:{threshold:19390,rate:.09},plan2:{threshold:26575,rate:.09},plan4:{threshold:0,rate:0}},postgraduateLoans:{england:{threshold:21e3,rate:.06},wales:{threshold:21e3,rate:.06},scotland:{threshold:18330,rate:.09},northernIreland:{threshold:18330,rate:.09}}},{year:"2021-22",studentLoans:{plan1:{threshold:19895,rate:.09},plan2:{threshold:27295,rate:.09},plan4:{threshold:25e3,rate:.09}},postgraduateLoans:{england:{threshold:21e3,rate:.06},wales:{threshold:21e3,rate:.06},scotland:{threshold:18330,rate:.09},northernIreland:{threshold:18330,rate:.09}}},{year:"2022-23",studentLoans:{plan1:{threshold:20195,rate:.09},plan2:{threshold:27295,rate:.09},plan4:{threshold:25375,rate:.09}},postgraduateLoans:{england:{threshold:21e3,rate:.06},wales:{threshold:21e3,rate:.06},scotland:{threshold:18330,rate:.09},northernIreland:{threshold:18330,rate:.09}}}];var j=t=>{let e={year:new o("year",{form:t}),isStudent:new o("is-student",{form:t}),isPostGraduate:new o("is-post-graduate",{form:t})};return e.studentLoanPlan=new o("student-loan-plan",{form:t,visibleIf:()=>!!e.isStudent.getValue(),toggleOptions:[{option:{name:"plan4"},query:{name:"postGraduateLoanCountry",value:"scotland"}}]}),e.postGraduateLoanCountry=new o("post-graduate-loan-country",{form:t,visibleIf:()=>!!e.isPostGraduate.getValue()}),e.allIncome=new o("all-income",{form:t,visibleIf:()=>{let n=!!e.isStudent.getValue(),a=!!e.isPostGraduate.getValue();return!n&&!a?!1:!!(n&&e.studentLoanPlan.getValue()!==""||a&&e.postGraduateLoanCountry.getValue()!=="")}}),e};var W=(t,e,n)=>{if(!e)return;let a={studentLoanTotal:new p("student-loan-total",{form:t,value:()=>{let{studentLoans:r}=n,i=e.allIncome.getValueAsNumber(),l=e.studentLoanPlan.getValue();if(!l)return 0;let c=r[l],{threshold:s,rate:u}=c;return i>=s?(i-s)*u:0},visibleIf:()=>!!e.isStudent.getValue()&&e.studentLoanPlan.getValue()!==""}),postGraduateTotal:new p("post-graduate-total",{form:t,value:()=>{let{postgraduateLoans:r}=n,i=e.allIncome.getValueAsNumber(),l=e.postGraduateLoanCountry.getValue();if(!l)return 0;let c=r[l],{threshold:s,rate:u}=c;return i>=s?(i-s)*u:0},visibleIf:()=>!!e.isPostGraduate.getValue()&&e.postGraduateLoanCountry.getValue()!==""})};return a.loanTotal=new p("loan-total",{form:t,value:()=>a.studentLoanTotal.value()+a.postGraduateTotal.value()}),a};var $=t=>{!t||b(t,D,j,W)};window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let{pathname:t}=window.location,e=document.querySelector("form");switch(t){case"/dividends":S(e);break;case"/capital-gains":k(e);break;case"/national-insurance":G(e);break;case"/mileage":q(e);break;case"/student-and-post-graduate-loans":$(e);break}});})();
